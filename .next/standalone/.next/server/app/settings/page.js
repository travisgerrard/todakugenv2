(()=>{var e={};e.id=938,e.ids=[938],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},7280:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var s=r(482),a=r(9108),n=r(2563),i=r.n(n),l=r(8300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9700)),"/root/todakugenv2/src/app/settings/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,477)),"/root/todakugenv2/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],c=["/root/todakugenv2/src/app/settings/page.tsx"],u="/settings/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/settings/page",pathname:"/settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8107:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},3249:(e,t,r)=>{Promise.resolve().then(r.bind(r,403))},7794:(e,t,r)=>{Promise.resolve().then(r.bind(r,4895))},4895:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(5344),a=r(3729),n=r(5094),i=r(6540),l=r(7361),o=r(8704),d=r(8428),c=r(8157);function u(){let[e,t]=(0,a.useState)(""),[r,u]=(0,a.useState)(""),[p,x]=(0,a.useState)("0"),[m,h]=(0,a.useState)("0"),[f,g]=(0,a.useState)("0"),[v,b]=(0,a.useState)(!0),[y,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(null),[k,S]=(0,a.useState)(!1),_=(0,o.e)(),P=(0,d.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let{data:{session:e}}=await _.auth.getSession();if(!e){P.push("/");return}let{data:r,error:s}=await _.from("profiles").select("*").eq("id",e.user.id).single();if(s)throw s;t(r.full_name||""),u(r.avatar_url||""),x(r.wanikani_level?.toString()||"0"),h(r.genki_chapter?.toString()||"0"),g(r.tadoku_level?.toString()||"0")}catch(e){console.error("Error loading profile:",e),N(e instanceof Error?e.message:"Failed to load profile")}finally{b(!1)}})()},[_,P]);let q=async t=>{t.preventDefault(),j(!0),N(null),S(!1);try{let{data:{session:t}}=await _.auth.getSession();if(!t)throw Error("No active session");let{error:s}=await _.from("profiles").update({full_name:e,avatar_url:r,wanikani_level:parseInt(p),genki_chapter:parseInt(m),tadoku_level:parseInt(f)}).eq("id",t.user.id);if(s)throw s;S(!0)}catch(e){console.error("Error updating profile:",e),N(e instanceof Error?e.message:"Failed to update profile")}finally{j(!1)}};return v?s.jsx("main",{className:"flex-1",children:s.jsx("div",{className:"container mx-auto px-4 py-8 sm:py-12",children:s.jsx("div",{className:"text-center",children:"Loading profile..."})})}):s.jsx("main",{className:"flex-1",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 sm:py-12",children:[s.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Profile Settings"}),(0,s.jsxs)("form",{onSubmit:q,className:"space-y-6 max-w-md",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(l._,{htmlFor:"fullName",children:"Full Name"}),s.jsx(i.I,{id:"fullName",value:e,onChange:e=>t(e.target.value),placeholder:"Your full name"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(l._,{htmlFor:"avatarUrl",children:"Avatar URL"}),s.jsx(i.I,{id:"avatarUrl",value:r,onChange:e=>u(e.target.value),placeholder:"URL to your avatar image"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(l._,{htmlFor:"wanikaniLevel",children:"Wanikani Level"}),(0,s.jsxs)(c.Ph,{value:p,onValueChange:x,children:[s.jsx(c.i4,{children:s.jsx(c.ki,{placeholder:"Select Wanikani level"})}),s.jsx(c.Bw,{className:"max-h-[300px] overflow-y-auto",children:[...Array(61)].map((e,t)=>(0,s.jsxs)(c.Ql,{value:t.toString(),children:["Level ",t]},t))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(l._,{htmlFor:"genkiChapter",children:"Genki Chapter"}),(0,s.jsxs)(c.Ph,{value:m,onValueChange:h,children:[s.jsx(c.i4,{children:s.jsx(c.ki,{placeholder:"Select Genki chapter"})}),s.jsx(c.Bw,{className:"max-h-[300px] overflow-y-auto",children:[...Array(24)].map((e,t)=>(0,s.jsxs)(c.Ql,{value:t.toString(),children:["Chapter ",t]},t))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(l._,{htmlFor:"tadokuLevel",children:"Tadoku Level"}),(0,s.jsxs)(c.Ph,{value:f,onValueChange:g,children:[s.jsx(c.i4,{children:s.jsx(c.ki,{placeholder:"Select Tadoku level"})}),s.jsx(c.Bw,{children:[...Array(6)].map((e,t)=>(0,s.jsxs)(c.Ql,{value:t.toString(),children:["Level ",t]},t))})]})]}),w&&s.jsx("div",{className:"text-red-500 text-sm",children:w}),k&&s.jsx("div",{className:"text-green-500 text-sm",children:"Profile updated successfully!"}),s.jsx(n.z,{type:"submit",disabled:y,children:y?"Saving...":"Save Changes"})]})]})})}},403:(e,t,r)=>{"use strict";r.r(t),r.d(t,{NavBar:()=>c});var s=r(5344),a=r(8704),n=r(3729),i=r(5094),l=r(6506),o=r(8428),d=r(3746);let c=()=>{let[e,t]=(0,n.useState)(null),[r,c]=(0,n.useState)(!0),u=(0,o.useRouter)(),p=(0,a.e)(),x=(0,n.useCallback)(async()=>{try{c(!0),console.log("Starting sign in...");let{data:e,error:t}=await p.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(t)throw console.error("Sign in error:",t),t;console.log("Sign in response:",e),e?.url&&(window.location.href=e.url)}catch(e){console.error("Error during sign in:",e),c(!1)}},[p.auth]),m=(0,n.useCallback)(async()=>{try{c(!0),console.log("Starting sign out...");let{error:e}=await p.auth.signOut();if(e)throw e;t(null),u.refresh()}catch(e){console.error("Error signing out:",e)}finally{c(!1)}},[p.auth,u]);return((0,n.useEffect)(()=>{let e=!0;(async()=>{try{console.log("Initializing auth...");let{data:{session:r},error:s}=await p.auth.getSession();if(s){console.error("Error getting session:",s);return}console.log("Session:",r),e&&t(r?.user??null)}catch(e){console.error("Error getting session:",e)}finally{e&&c(!1)}})();let{data:{subscription:r}}=p.auth.onAuthStateChange((r,s)=>{console.log("Auth state changed:",r,s),e&&(t(s?.user??null),("SIGNED_IN"===r||"SIGNED_OUT"===r)&&u.refresh())});return()=>{e=!1,r.unsubscribe()}},[p.auth,u]),r)?s.jsx("nav",{className:"border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between h-16 items-center",children:[s.jsx(l.default,{href:"/",className:"text-xl font-bold",children:"Tadoku Reader"}),s.jsx("div",{children:s.jsx(i.z,{disabled:!0,children:"Loading..."})})]})})}):s.jsx("nav",{className:"border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between h-16 items-center",children:[s.jsx(l.default,{href:"/",className:"text-xl font-bold",children:"Tadoku Reader"}),s.jsx("div",{className:"flex items-center gap-4",children:e?(0,s.jsxs)(s.Fragment,{children:[s.jsx(l.default,{href:"/settings",className:"text-sm text-gray-500 hover:text-gray-700",children:s.jsx(d.Z,{className:"h-5 w-5"})}),s.jsx("span",{className:"text-sm text-gray-500",children:e.email}),s.jsx(i.z,{variant:"outline",onClick:m,disabled:r,children:r?"Signing out...":"Sign Out"})]}):s.jsx(i.z,{onClick:x,disabled:r,children:r?"Redirecting...":"Sign in with Google"})})]})})})}},5094:(e,t,r)=>{"use strict";r.d(t,{z:()=>d});var s=r(5344),a=r(3729),n=r(2751),i=r(9247),l=r(1453);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...i},d)=>{let c=a?n.g7:"button";return s.jsx(c,{className:(0,l.cn)(o({variant:t,size:r,className:e})),ref:d,...i})});d.displayName="Button"},6540:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var s=r(5344),a=r(3729),n=r(1453);let i=a.forwardRef(({className:e,type:t,...r},a)=>s.jsx("input",{type:t,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r}));i.displayName="Input"},7361:(e,t,r)=>{"use strict";r.d(t,{_:()=>d});var s=r(5344),a=r(3729),n=r(4217),i=r(9247),l=r(1453);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef(({className:e,...t},r)=>s.jsx(n.f,{ref:r,className:(0,l.cn)(o(),e),...t}));d.displayName=n.f.displayName},8157:(e,t,r)=>{"use strict";r.d(t,{Bw:()=>p,Ph:()=>d,Ql:()=>x,i4:()=>u,ki:()=>c});var s=r(5344),a=r(3729),n=r(6453),i=r(5390),l=r(2312),o=r(1453);let d=n.fC;n.ZA;let c=n.B4,u=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(n.xz,{ref:a,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:[t,s.jsx(n.JO,{asChild:!0,children:s.jsx(i.Z,{className:"h-4 w-4 opacity-50"})})]}));u.displayName=n.xz.displayName;let p=a.forwardRef(({className:e,children:t,position:r="popper",...a},i)=>s.jsx(n.h_,{children:s.jsx(n.VY,{ref:i,className:(0,o.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:s.jsx(n.l_,{className:(0,o.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));p.displayName=n.VY.displayName,a.forwardRef(({className:e,...t},r)=>s.jsx(n.__,{ref:r,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=n.__.displayName;let x=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(n.ck,{ref:a,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(n.wU,{children:s.jsx(l.Z,{className:"h-4 w-4"})})}),s.jsx(n.eT,{children:t})]}));x.displayName=n.ck.displayName,a.forwardRef(({className:e,...t},r)=>s.jsx(n.Z0,{ref:r,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=n.Z0.displayName},8704:(e,t,r)=>{"use strict";r.d(t,{e:()=>n});var s=r(7435);let a=null,n=()=>(a||(a=(0,s.createClientComponentClient)()),a)},1453:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(6815),a=r(9377);function n(...e){return(0,a.m6)((0,s.W)(e))}},477:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p,metadata:()=>u});var s=r(5036),a=r(2195),n=r.n(a);r(5023);var i=r(6843);let l=(0,i.createProxy)(String.raw`/root/todakugenv2/src/components/nav-bar.tsx`),{__esModule:o,$$typeof:d}=l;l.default;let c=(0,i.createProxy)(String.raw`/root/todakugenv2/src/components/nav-bar.tsx#NavBar`),u={title:"Tadoku Japanese Reader",description:"Generate personalized Japanese graded readers based on your level and interests."};function p({children:e}){return s.jsx("html",{lang:"en",children:(0,s.jsxs)("body",{className:n().className,children:[s.jsx(c,{}),e]})})}},9700:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>i});let s=(0,r(6843).createProxy)(String.raw`/root/todakugenv2/src/app/settings/page.tsx`),{__esModule:a,$$typeof:n}=s,i=s.default},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[225,606,150],()=>r(7280));module.exports=s})();